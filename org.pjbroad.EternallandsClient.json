{
	"app-id": "org.pjbroad.EternallandsClient",
	"runtime": "org.freedesktop.Platform",
	"sdk": "org.freedesktop.Sdk",
	"runtime-version": "18.08",
	"command": "launcher.sh",
	"finish-args": [
		"--share=ipc",
		"--socket=x11",
		"--socket=wayland",
		"--socket=pulseaudio",
		"--share=network",
		"--device=dri",
		"--filesystem=~/.elc:create"
	],

	"cleanup" : [
		"*.la",
		"*.a",
		"/include",
		"/lib/pkgconfig",
		"/lib/debug"
	],

	"modules": [
		"shared-modules/glu/glu-9.json",

		{
			"name": "libpng",
			"config-opts": [ "--disable-static" ],
			"cleanup": [ "/bin", "/share" ],
			"sources": [
				{
					"type": "archive",
					"url": "https://downloads.sourceforge.net/project/libpng/libpng16/1.6.35/libpng-1.6.35.tar.gz",
					"sha256": "2b82ab3e996803b80bc73206857e826a155d3ebb374e8eb03a87a63c6f672cf7"
				}
			]
		},

		{
			"name": "libcal3d",
			"config-opts": [ "--disable-static" ],
			"cleanup": [ "/bin", "/share" ],
			"sources": [
				{
					"type": "archive",
					"url": "https://github.com/raduprv/Eternal-Lands/releases/download/1.9.5.2/cal3d-0.11.0.tar.gz",
					"sha256": "b3a3fc80053cc00fbe7585f972c0e11669dbd2a13a371a10cc2dac7c9ed5f473"
				},
				{
					"type": "patch",
					"path": "cal3d-0.11.0-patch"
				}
			]
		},

		{
			"name": "client",
			"buildsystem": "cmake",
			"config-opts": [
				"-DCMAKE_BUILD_TYPE=Release",
				"-DEXEC=el.linux.bin",
				"-DLOCAL_NLOHMANN_JSON=On",
				"-DTTF=On",
				"-DVERSION_PREFIX=1.9.5"
			],
			"no-make-install": true,
			"build-commands": [
					"install el.linux.bin /app/bin"
			],
			"sources": [
				{
					"type": "git",
					"url": "https://github.com/raduprv/Eternal-Lands"
				}
			]
		},

		{
			"name": "launcher",
			"buildsystem": "simple",
			"build-commands": [
					"install launcher.sh /app/bin"
			],
			"sources": [
				{
					"type": "file",
					"path": "launcher.sh",
					"dest-filename": "launcher.sh"
				}
			]
		},

		{
			"name": "exports",
			"buildsystem": "simple",
			"build-commands": [
					"mkdir -p /app/share/metainfo/ /app/share/icons/hicolor/128x128/apps/ /app/share/applications/",
 					"install -Dm644 org.pjbroad.EternallandsClient.appdata.xml /app/share/metainfo/",
 					"install -Dm644 org.pjbroad.EternallandsClient.png /app/share/icons/hicolor/128x128/apps/",
					"install -Dm644 org.pjbroad.EternallandsClient.desktop /app/share/applications/"
			],
			"sources": [
				{
					"type": "file",
					"path": "org.pjbroad.EternallandsClient.png"
				},
				{
					"type": "file",
					"path": "org.pjbroad.EternallandsClient.desktop"
				},
				{
					"type": "file",
					"path": "org.pjbroad.EternallandsClient.appdata.xml"
				}
			]
		},

		{
			"name": "data",
			"buildsystem": "simple",
			"build-commands": [
					"mkdir -p /app/data",
					"mv * /app/data/"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://twinmoons.org.uk/el/git/el_data_20210307.zip",
					"sha256": "aab87cdc50867011fae28bf5bce802cd707d53e526f13275cff36cad396992ee"
				}
			]
		},

		{
			"name": "sound",
			"buildsystem": "simple",
			"build-commands": [
					"mkdir -p /app/data/sound",
					"mv * /app/data/sound/"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://github.com/raduprv/Eternal-Lands/releases/download/1.9.5.8/eternallands-sound_1.9.5-1.zip",
					"sha256": "ba3fc54f8e52f09937126ea38f66f7290764a8137480afd1c32a1cf5b65e8ecd"
				}
			]
		},

		{
			"name": "music",
			"buildsystem": "simple",
			"build-commands": [
					"mkdir -p /app/data/music",
					"mv * /app/data/music/"
			],
			"sources": [
				{
					"type": "archive",
					"url": "https://github.com/raduprv/Eternal-Lands/releases/download/1.9.5.2/music_full.zip",
					"sha256": "1ea4de25081034ac684aaebf127ab6ca8524ba5367532863d84d63837dd631ec"
				}
			]
		}
	]
}
